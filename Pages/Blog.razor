@page "/blog"
@using System.Net.Http
@using Markdig
@using MyPortfolio.Services
@using MyPortfolio.Components.Blog

@inject ContentService ContentService

<PageTitle>My Adventures</PageTitle>

<CascadingValue Value="currentPalette">
    <MudContainer>
        <MudGrid>
            <MudItem sm="12" md="6">
                <MudText Typo="Typo.h4" class="mt-5" Color="Color.Secondary">My Adventures</MudText>
                @if (content.Count == 0)
                {
                    <MudProgressCircular Class="mt-5" Color="Color.Primary" Indeterminate="true" />
                }
                else
                {
                    @foreach (var item in content)
                    {
                        <BlogpostTeaser TeaserContent="@(new MarkupString(Markdown.ToHtml(item)))" />
                    }
                }
            </MudItem>
        </MudGrid>
    </MudContainer>
</CascadingValue>

@code {
    [CascadingParameter]
    public Palette? currentPalette { get; set; }
    private List<string> content = new List<string>();
    private string errorMessage = "Loading...";
    protected override async Task OnInitializedAsync()
    {
        try
        {
            content = await ContentService.LoadContentAsync();
        }
        catch (Exception ex)
        {
            errorMessage = ex.Message;
        }
    }


}